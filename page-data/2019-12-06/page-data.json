{"componentChunkName":"component---src-templates-post-jsx","path":"/2019-12-06","result":{"data":{"markdownRemark":{"html":"<h1>C#のパフォーマンス最適化技法</h1>\n<h2>速度測定</h2>\n<h3>BenchmarkDotNet ライブラリを使う</h3>\n<p>Stopwatch より正確なベンチマークパッケージ。</p>\n<p>使い方は公式ページ参照。</p>\n<p><a href=\"https://benchmarkdotnet.org/\">benchmarkdotnet 公式</a></p>\n<h3>Stopwatch クラスを使う</h3>\n<p>BenchmarkDotNet 程正確ではないが、簡単に使える。</p>\n<p><a href=\"https://docs.microsoft.com/ja-jp/dotnet/api/system.diagnostics.stopwatch\">Microsoft Docs Stopwatch クラス</a></p>\n<p>以下のような Utilty があれば楽。</p>\n<div class=\"gatsby-highlight\" data-language=\"cs\"><pre class=\"language-cs\"><code class=\"language-cs\">    <span class=\"token comment\">/// &lt;summary></span>\n    <span class=\"token comment\">/// 処理時間計測Utilty</span>\n    <span class=\"token comment\">/// &lt;/summary></span>\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">static</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">StopwatchUtilty</span>\n    <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">private</span> <span class=\"token keyword\">static</span> Dictionary<span class=\"token operator\">&lt;</span><span class=\"token keyword\">string</span><span class=\"token punctuation\">,</span> Stopwatch<span class=\"token operator\">></span> _dic <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token generic-method\"><span class=\"token function\">Dictionary</span><span class=\"token punctuation\">&lt;</span><span class=\"token keyword\">string</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">Stopwatch</span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n        <span class=\"token comment\">/// &lt;summary></span>\n        <span class=\"token comment\">/// 計測開始</span>\n        <span class=\"token comment\">/// &lt;/summary></span>\n        <span class=\"token comment\">/// &lt;param name=\"processName\">&lt;/param></span>\n        <span class=\"token keyword\">public</span> <span class=\"token keyword\">static</span> <span class=\"token keyword\">void</span> <span class=\"token function\">Start</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">string</span> processName<span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">{</span>\n            _dic<span class=\"token punctuation\">[</span>processName<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Stopwatch</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            _dic<span class=\"token punctuation\">[</span>processName<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span><span class=\"token function\">Start</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n\n        <span class=\"token comment\">/// &lt;summary></span>\n        <span class=\"token comment\">/// 再計測開始</span>\n        <span class=\"token comment\">/// &lt;/summary></span>\n        <span class=\"token comment\">/// &lt;param name=\"processName\">&lt;/param></span>\n        <span class=\"token keyword\">public</span> <span class=\"token keyword\">static</span> <span class=\"token keyword\">void</span> <span class=\"token function\">Restart</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">string</span> processName<span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">{</span>\n            _dic<span class=\"token punctuation\">[</span>processName<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span><span class=\"token function\">Restart</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n\n        <span class=\"token comment\">/// &lt;summary></span>\n        <span class=\"token comment\">/// 計測停止</span>\n        <span class=\"token comment\">/// &lt;/summary></span>\n        <span class=\"token comment\">/// &lt;param name=\"processName\">&lt;/param></span>\n        <span class=\"token keyword\">public</span> <span class=\"token keyword\">static</span> <span class=\"token keyword\">void</span> <span class=\"token function\">Stop</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">string</span> processName<span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">{</span>\n            _dic<span class=\"token punctuation\">[</span>processName<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span><span class=\"token function\">Stop</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n\n\n        <span class=\"token comment\">/// &lt;summary></span>\n        <span class=\"token comment\">/// 計測結果</span>\n        <span class=\"token comment\">/// &lt;/summary></span>\n        <span class=\"token comment\">/// &lt;param name=\"processName\">&lt;/param></span>\n        <span class=\"token keyword\">public</span> <span class=\"token keyword\">static</span> <span class=\"token keyword\">void</span> <span class=\"token function\">Result</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">string</span> processName<span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">{</span>\n            <span class=\"token comment\">// 結果表示</span>\n            Console<span class=\"token punctuation\">.</span><span class=\"token function\">WriteLine</span><span class=\"token punctuation\">(</span>$<span class=\"token string\">\" {processName},{_dic[processName].Elapsed.ToString()}\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span></code></pre></div>\n<h2>最適化</h2>\n<h2>Boxing</h2>\n<h3>メモリ最適化</h3>\n<p>VisualStudio のデバッグ-ウィンドウ-診断ツールの表示から診断ツール表示。</p>\n<p>適宜スナップショットをとって直前のスナップショットと比較する。</p>\n<p>参照の削除。(参照されていると GC で解放されないため)</p>\n<p>イベントの削除。(参照が残るので)</p>\n<p>Dispose の徹底。(using を使う)</p>\n<p>Lambda での変数のキャプチャに気をつける。</p>","frontmatter":{"date":"2019-12-06","title":"はじめに","path":"/2019-12-06","tags":["C#"],"description":"","cover":{"childImageSharp":{"fluid":{"base64":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAAHeV37IAAAACXBIWXMAAAPoAAAD6AG1e1JrAAAAu0lEQVQ4y2OomfXif83M52DMgMrBZMCkQTSUDZdFxrgFa2e//F876yWqYPUMorQjOQ4fRnFmUc+d/+WTH/0v6b/3v7jv3v+ySQ/JMZGQohnEKsQwEeoEUJiAwwXNSXCFFVOf/C+dcB+MQR4BeQwjIKnjGdIVEhmOtDVwBgkGgkIOlBRy2679L+q9CwzVB/8Lum79z++4+b+w+zY4dPM7b/4vm/gQJZTxuxAoBo9DKBuMoWkeW/wOsjDEgwFnmQUoSc4I+QAAAABJRU5ErkJggg==","aspectRatio":1.497737556561086,"src":"/static/02057bc3a4e9c5099e360056a485b3b0/af5e2/noimage.png","srcSet":"/static/02057bc3a4e9c5099e360056a485b3b0/af5e2/noimage.png 331w","srcWebp":"/static/02057bc3a4e9c5099e360056a485b3b0/7cb23/noimage.webp","srcSetWebp":"/static/02057bc3a4e9c5099e360056a485b3b0/7cb23/noimage.webp 331w","sizes":"(max-width: 331px) 100vw, 331px"},"resize":{"src":"/static/02057bc3a4e9c5099e360056a485b3b0/d8210/noimage.png"}}}}}},"pageContext":{"isCreatedByStatefulCreatePages":false,"pathSlug":"/2019-12-06","prev":{"excerpt":"はじめに このサイトは IT 技術について個人的に学んだことを記述するための\n備忘録的な目的で使用します。","frontmatter":{"title":"はじめに","path":"/2019-11-24","tags":["その他"],"description":"","date":"2019年11月24日","cover":{"childImageSharp":{"fluid":{"tracedSVG":"data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20width='400'%20height='267'%3e%3cpath%20d='M116%20125l-1%2013v12h3c2%200%202%200%202-7%200-8%201-8%206%201%203%205%205%206%207%206h2v-13c0-12-1-13-3-13s-2%200-2%208v8l-5-8c-5-7-8-9-9-7m31%200c-3%202-5%206-5%2012%200%2011%206%2016%2013%2013%205-2%206-5%206-13%200-7%200-7-3-10s-7-4-11-2m32%200l-1%2013v12h6v-13c0-12-1-13-3-13l-2%201m13%200l-1%2013v12h3c3%200%203%200%203-6l1-6%201%203c3%205%205%205%208%200l3-4v6c0%207%200%207%203%207h2v-12l-1-14c-2-1-5%201-7%207l-4%206-4-6c-2-6-5-8-7-6m36%203l-5%2013-3%209h3c2%200%203-1%203-2%201-2%202-2%205-2%204%200%205%200%206%202%200%201%201%202%203%202h3l-5-13c-5-14-7-16-10-9m24-3c-4%202-5%205-5%2014%201%209%203%2011%2010%2011%206%200%209-3%209-9v-5h-4c-4%200-5%200-5%202l2%202c3%200%203%204%200%205s-4%201-5-1c-2-1-3-10-1-13%201-2%205-3%207%200l6%201c0-6-8-9-14-7m22%200l-1%2013v12h9c8%200%209%200%209-2s-1-2-6-2c-6%200-6-1-6-3%200-3%200-4%205-4%204%200%205%200%205-2s-1-2-5-2c-5%200-5-1-5-3s0-3%206-3c5%200%206-1%206-2%200-2-1-3-9-3l-8%201m-125%205c-2%201-3%2010-1%2013%204%206%208%202%208-5%200-8-3-11-7-8'%20fill='%232B2B2F'%20fill-rule='evenodd'/%3e%3c/svg%3e","srcWebp":"/static/02057bc3a4e9c5099e360056a485b3b0/34747/noimage.webp","srcSetWebp":"/static/02057bc3a4e9c5099e360056a485b3b0/d7587/noimage.webp 250w,\n/static/02057bc3a4e9c5099e360056a485b3b0/34747/noimage.webp 331w","src":"/static/02057bc3a4e9c5099e360056a485b3b0/e9fe8/noimage.png","srcSet":"/static/02057bc3a4e9c5099e360056a485b3b0/81e55/noimage.png 250w,\n/static/02057bc3a4e9c5099e360056a485b3b0/e9fe8/noimage.png 331w","base64":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAIAAAAmMtkJAAAACXBIWXMAAAsSAAALEgHS3X78AAAAjklEQVQoz72RTQrDIBBGc/9zuTEoHdH4h+Bqot6ig6EhWTRtE9K3GGSYp9/gUEqZfwQRl8NwQl65Ve4JsfOV3FqjSv36onSOZLqb5kIIjDGllHNOCME5l1I+APg4eu9pYBth9zKdc84AYK1NKVE106S1NsZQM8Z4JC9+q3Ubm7ZYw3/eGd/w56+6UZ4v8ASnhbjAITjaagAAAABJRU5ErkJggg==","originalImg":"/static/02057bc3a4e9c5099e360056a485b3b0/e9fe8/noimage.png"}}}}},"next":null,"relatedPosts":[],"latestPosts":[{"excerpt":"はじめに このサイトは IT 技術について個人的に学んだことを記述するための\n備忘録的な目的で使用します。","frontmatter":{"title":"はじめに","path":"/2019-11-24","tags":["その他"],"description":"","date":"2019年11月24日","cover":{"childImageSharp":{"fluid":{"tracedSVG":"data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20width='400'%20height='267'%3e%3cpath%20d='M116%20125l-1%2013v12h3c2%200%202%200%202-7%200-8%201-8%206%201%203%205%205%206%207%206h2v-13c0-12-1-13-3-13s-2%200-2%208v8l-5-8c-5-7-8-9-9-7m31%200c-3%202-5%206-5%2012%200%2011%206%2016%2013%2013%205-2%206-5%206-13%200-7%200-7-3-10s-7-4-11-2m32%200l-1%2013v12h6v-13c0-12-1-13-3-13l-2%201m13%200l-1%2013v12h3c3%200%203%200%203-6l1-6%201%203c3%205%205%205%208%200l3-4v6c0%207%200%207%203%207h2v-12l-1-14c-2-1-5%201-7%207l-4%206-4-6c-2-6-5-8-7-6m36%203l-5%2013-3%209h3c2%200%203-1%203-2%201-2%202-2%205-2%204%200%205%200%206%202%200%201%201%202%203%202h3l-5-13c-5-14-7-16-10-9m24-3c-4%202-5%205-5%2014%201%209%203%2011%2010%2011%206%200%209-3%209-9v-5h-4c-4%200-5%200-5%202l2%202c3%200%203%204%200%205s-4%201-5-1c-2-1-3-10-1-13%201-2%205-3%207%200l6%201c0-6-8-9-14-7m22%200l-1%2013v12h9c8%200%209%200%209-2s-1-2-6-2c-6%200-6-1-6-3%200-3%200-4%205-4%204%200%205%200%205-2s-1-2-5-2c-5%200-5-1-5-3s0-3%206-3c5%200%206-1%206-2%200-2-1-3-9-3l-8%201m-125%205c-2%201-3%2010-1%2013%204%206%208%202%208-5%200-8-3-11-7-8'%20fill='%232B2B2F'%20fill-rule='evenodd'/%3e%3c/svg%3e","srcWebp":"/static/02057bc3a4e9c5099e360056a485b3b0/34747/noimage.webp","srcSetWebp":"/static/02057bc3a4e9c5099e360056a485b3b0/d7587/noimage.webp 250w,\n/static/02057bc3a4e9c5099e360056a485b3b0/34747/noimage.webp 331w","src":"/static/02057bc3a4e9c5099e360056a485b3b0/e9fe8/noimage.png","srcSet":"/static/02057bc3a4e9c5099e360056a485b3b0/81e55/noimage.png 250w,\n/static/02057bc3a4e9c5099e360056a485b3b0/e9fe8/noimage.png 331w","base64":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAIAAAAmMtkJAAAACXBIWXMAAAsSAAALEgHS3X78AAAAjklEQVQoz72RTQrDIBBGc/9zuTEoHdH4h+Bqot6ig6EhWTRtE9K3GGSYp9/gUEqZfwQRl8NwQl65Ve4JsfOV3FqjSv36onSOZLqb5kIIjDGllHNOCME5l1I+APg4eu9pYBth9zKdc84AYK1NKVE106S1NsZQM8Z4JC9+q3Ubm7ZYw3/eGd/w56+6UZ4v8ASnhbjAITjaagAAAABJRU5ErkJggg==","originalImg":"/static/02057bc3a4e9c5099e360056a485b3b0/e9fe8/noimage.png"}}}}},{"excerpt":"C#のパフォーマンス最適化技法 速度測定 BenchmarkDotNet ライブラリを使う Stopwatch より正確なベンチマークパッケージ。 使い方は公式ページ参照。 benchmarkdotnet 公式 Stopwatch クラスを使う BenchmarkDotNet…","frontmatter":{"title":"はじめに","path":"/2019-12-06","tags":["C#"],"description":"","date":"2019年12月06日","cover":{"childImageSharp":{"fluid":{"tracedSVG":"data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20width='400'%20height='267'%3e%3cpath%20d='M116%20125l-1%2013v12h3c2%200%202%200%202-7%200-8%201-8%206%201%203%205%205%206%207%206h2v-13c0-12-1-13-3-13s-2%200-2%208v8l-5-8c-5-7-8-9-9-7m31%200c-3%202-5%206-5%2012%200%2011%206%2016%2013%2013%205-2%206-5%206-13%200-7%200-7-3-10s-7-4-11-2m32%200l-1%2013v12h6v-13c0-12-1-13-3-13l-2%201m13%200l-1%2013v12h3c3%200%203%200%203-6l1-6%201%203c3%205%205%205%208%200l3-4v6c0%207%200%207%203%207h2v-12l-1-14c-2-1-5%201-7%207l-4%206-4-6c-2-6-5-8-7-6m36%203l-5%2013-3%209h3c2%200%203-1%203-2%201-2%202-2%205-2%204%200%205%200%206%202%200%201%201%202%203%202h3l-5-13c-5-14-7-16-10-9m24-3c-4%202-5%205-5%2014%201%209%203%2011%2010%2011%206%200%209-3%209-9v-5h-4c-4%200-5%200-5%202l2%202c3%200%203%204%200%205s-4%201-5-1c-2-1-3-10-1-13%201-2%205-3%207%200l6%201c0-6-8-9-14-7m22%200l-1%2013v12h9c8%200%209%200%209-2s-1-2-6-2c-6%200-6-1-6-3%200-3%200-4%205-4%204%200%205%200%205-2s-1-2-5-2c-5%200-5-1-5-3s0-3%206-3c5%200%206-1%206-2%200-2-1-3-9-3l-8%201m-125%205c-2%201-3%2010-1%2013%204%206%208%202%208-5%200-8-3-11-7-8'%20fill='%232B2B2F'%20fill-rule='evenodd'/%3e%3c/svg%3e","srcWebp":"/static/02057bc3a4e9c5099e360056a485b3b0/34747/noimage.webp","srcSetWebp":"/static/02057bc3a4e9c5099e360056a485b3b0/d7587/noimage.webp 250w,\n/static/02057bc3a4e9c5099e360056a485b3b0/34747/noimage.webp 331w","src":"/static/02057bc3a4e9c5099e360056a485b3b0/e9fe8/noimage.png","srcSet":"/static/02057bc3a4e9c5099e360056a485b3b0/81e55/noimage.png 250w,\n/static/02057bc3a4e9c5099e360056a485b3b0/e9fe8/noimage.png 331w","base64":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAIAAAAmMtkJAAAACXBIWXMAAAsSAAALEgHS3X78AAAAjklEQVQoz72RTQrDIBBGc/9zuTEoHdH4h+Bqot6ig6EhWTRtE9K3GGSYp9/gUEqZfwQRl8NwQl65Ve4JsfOV3FqjSv36onSOZLqb5kIIjDGllHNOCME5l1I+APg4eu9pYBth9zKdc84AYK1NKVE106S1NsZQM8Z4JC9+q3Ubm7ZYw3/eGd/w56+6UZ4v8ASnhbjAITjaagAAAABJRU5ErkJggg==","originalImg":"/static/02057bc3a4e9c5099e360056a485b3b0/e9fe8/noimage.png"}}}}}]}}}